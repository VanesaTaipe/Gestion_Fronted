<div class="card-wrapper bg-white rounded-xl shadow-md hover:shadow-lg transition-shadow p-4 cursor-pointer border border-gray-100"
     (click)="onCardClick($event)">
  
  <!-- Header: Título y Fecha -->
  <div class="flex justify-between items-start mb-3">
    <h3 class="font-bold text-gray-900 text-base flex-1 pr-2 leading-tight">
      {{ card.title }}
    </h3>
    
    <!-- Fecha límite (si existe) -->
    <div *ngIf="card.fecha_vencimiento" 
         class="flex items-center gap-1 text-sm text-gray-600 whitespace-nowrap">
      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
              d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
      </svg>
      <span>{{ formatDateShort(card.fecha_vencimiento) }}</span>
    </div>
  </div>

  <!-- Descripción (opcional, solo si existe) -->
  <p *ngIf="card.descripcion" class="text-sm text-gray-600 mb-3">
    Descripción
  </p>

  <!-- Footer: Asignado y Acciones -->
  <div class="flex items-center justify-between">
    <!-- Usuario asignado -->
    <div class="flex items-center gap-2">
      <div class="w-8 h-8 bg-gray-800 text-white rounded-full flex items-center justify-center text-sm font-semibold">
        {{ getUserInitial() }}
      </div>
      <span class="text-sm text-gray-600 font-medium">
        {{ card.asignado_a || 'Sin asignar' }}
      </span>
    </div>

    <!-- Botones de acción -->
    <div class="flex items-center gap-2" (click)="$event.stopPropagation()">
      <!-- Botón editar - abre el modal -->
      <button 
        (click)="onCardClick($event)"
        class="w-8 h-8 flex items-center justify-center text-green-600 hover:bg-green-50 rounded-full transition">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
        </svg>
      </button>

      <!-- Botón eliminar -->
      <button 
        (click)="onDelete($event)"
        class="w-8 h-8 flex items-center justify-center text-red-500 hover:bg-red-50 rounded-full transition">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
        </svg>
      </button>
    </div>
  </div>

  <!-- Etiqueta de prioridad -->
  <div class="mt-3">
    <span 
      class="inline-block px-3 py-1 rounded-full text-xs font-semibold"
      [ngClass]="{
        'bg-orange-500 text-white': card.prioridad === 'media',
        'bg-red-500 text-white': card.prioridad === 'alta',
        'bg-green-500 text-white': card.prioridad === 'baja',
        'bg-gray-300 text-gray-700': card.prioridad === 'No asignada'
      }">
      {{ card.prioridad || 'Media' }}
    </span>
  </div>

</div>