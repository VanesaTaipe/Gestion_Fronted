<div class="card-wrapper bg-white rounded-xl shadow-md hover:shadow-lg transition-shadow p-4 cursor-pointer border border-gray-100"
     (click)="onCardClick($event)">
  
  <!-- Header: Título y Fecha -->
  <div class="flex justify-between items-start mb-3">
    <h3 class="font-bold text-gray-900 text-base flex-1 pr-2 leading-tight">
      {{ card.title }}
    </h3>
    
    <!-- Fecha límite (si existe) -->
        <div *ngIf="card.fecha_vencimiento" 
            class="flex items-center gap-1 text-sm text-gray-600 whitespace-nowrap">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                  d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/>
          </svg>
          <span>{{ formatDateShort(card.fecha_vencimiento) }}</span>
        </div>
      </div>

    <!-- Descripción () -->
    <p  class="text-sm text-gray-600 mb-3">
      Descripción
    </p>

  <!-- Footer: Asignado y Acciones -->
  <div class="flex items-center justify-between">
    <!-- Usuario asignado -->
    <div class="flex items-center gap-2">
      <div class="w-8 h-8 bg-gray-800 text-white rounded-full flex items-center justify-center text-sm font-semibold">
        {{ getUserInitial() }}
      </div>
      <span class="text-sm text-gray-600 font-medium">
        {{ card.asignado_a || 'Sin asignar' }}
      </span>
    </div>

    <!-- Botones de acción -->
    <div class="flex items-center gap-2" (click)="$event.stopPropagation()">
      <!-- Botón editar - abre el modal -->
      <button 
        (click)="onCardClick($event)"
        class="w-8 h-8 flex items-center justify-center text-teal-600 hover:bg-teal-50 rounded-full transition"
        title="Ver detalles">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"/>
        </svg>
      </button>

      <!-- Botón eliminar -->
       <button 
          *ngIf="isLeader"
          (click)="onDelete($event)"
          class="w-8 h-8 flex items-center justify-center text-teal-600 hover:bg-teal-50 rounded-full transition"
          title="Eliminar tarjeta">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
                  d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
          </svg>
        </button>
          <div 
          class="flex items-center gap-1 text-teal-600 px-2 py-1 rounded-full hover:bg-teal-50 transition cursor-pointer"
          title="{{ getCommentCount() }} comentario(s)"
          *ngIf="getCommentCount() > 0">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" 
              d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/>
          </svg>
          <span class="text-sm font-medium">{{ getCommentCount() }}</span>
        </div>
        </div>
      </div>

  <!-- Etiqueta de prioridad -->
  <div class="mb-3">
    <span 
      class="inline-block px-3 py-1 rounded-full text-xs font-semibold"
      [ngClass]="getPriorityClass()">
      {{ getPriorityLabel() }}
    </span>
  </div>
</div>